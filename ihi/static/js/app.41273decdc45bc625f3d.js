webpackJsonp([1],{KbiS:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),i=n("mvHQ"),o=n.n(i);function r(e,t){return(!0===t?[]:t.split(",")).reduce(function(t,n){var s="^"===n[0]?-1==e.indexOf(n.slice(1)):-1!==e.indexOf(n);return t=t&&s},!0)}var a={name:"HelloWorld",mounted:function(){setInterval(this.checkUsers,1e3),this.fire("-system initialized-")},data:function(){return{since:(new Date).getTime(),flow:[{name:"Initial Push 1/2",message:"Almost release of DSE result la!",condition:"beacon",confirmed:!0},{name:"Initial Push 2/2",message:"Remember to check your scores.",condition:"beacon",confirmed:!0}],users:[{number:"+852 1234 5678",tags:["beacon"]},{number:"+852 4567 8901",tags:["beacon","engaged"]},{number:"+852 3456 7890",tags:["engaged"]},{number:"+852 4567 8901",tags:["beacon"]},{number:"+852 5678 9012",tags:["beacon"]}],console:"",history:[],delay:{}}},methods:{elapsedTime:function(){var e=((new Date).getTime()-this.since)/1e3;return Math.floor(e%60)},addFlow:function(){this.flow.push({name:"New Flow",message:"Add Your Message",condition:"",confirmed:!1,delay:0})},confirmFlow:function(e){0==this.flow[e].delay&&delete this.flow[e].delay,this.$set(this.flow[e],"confirmed",!0)},confirmAllFlows:function(){for(var e=0;e<this.flow.length;e++)this.confirmFlow(e)},scrollConsoleDown:function(){var e=this.$refs.console;e.scrollTop=e.scrollHeight-e.clientHeight},fire:function(e){this.console=this.console.concat("<div>"+e+"</div>"),this.scrollConsoleDown()},moveFlowToHistory:function(e){this.flow.shift().sentTimestamp=(new Date).getTime(),this.history=this.history.concat(),e&&delete this.delay[e]},checkUsers:function(){0==this.flow.length||this.flow.length>0&&this.flow[0].confirmed;for(var e=0;e<this.flow.length;e++){for(var t=(this.flow[e].name in this.delay),n=0;n<this.users.length;n++){var s=r(this.users[n].tags,this.flow[e].condition);(!t&&s&&this.flow[e].confirmed||t&&1==this.delay[this.flow[e].name]&&s&&this.flow[e].confirmed)&&this.fire([this.elapsedTime(),this.users[n].number,this.flow[e].message].join(" "))}(!this.flow[e].delay&&this.flow[e].confirmed||this.flow[e].delay&&1==this.delay[this.flow[e].name])&&this.moveFlowToHistory(this.flow[e].name),t?this.delay[this.flow[e].name]--:this.flow[e].delay&&(this.delay[this.flow[e].name]=this.flow[e].delay)}},addFiveSecondFlows:function(){this.flow=this.flow.concat([{name:"Five Second Flow 1",message:"Here it goes, 5s flows!",condition:!0,confirmed:!0},{name:"Five Second Flow 2",message:"Is this sent 5 seconds later?",condition:!0,confirmed:!0,delay:5}])}},computed:{jsonOutput:function(){return o()(this.flow,null,2)},historyOutput:function(){return o()(this.history,null,2)},tagsAvailable:function(){return this.users.reduce(function(e,t){return e=e.concat(t.tags)},[])}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("h1",[e._v("Conversation Flow Dispatcher")]),e._v(" "),n("div",{ref:"console",staticClass:"console",domProps:{innerHTML:e._s(e.console)}}),e._v(" "),n("small",[e._v("INTRO")]),e._v(" "),e._m(0),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col col-6"},[n("button",{on:{click:function(t){return e.addFlow()}}},[e._v("Add Flow")]),e._v(" "),n("button",{on:{click:function(t){return e.addFiveSecondFlows()}}},[e._v("Add 5s Delayed Flow")]),e._v(" "),n("button",{on:{click:function(t){return e.confirmAllFlows()}}},[e._v("Confirm All")]),e._v(" "),n("hr"),e._v(" "),e._l(e.flow,function(t,s){return n("div",{staticClass:"flow"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"f.name"}],attrs:{type:"text"},domProps:{value:t.name},on:{input:function(n){n.target.composing||e.$set(t,"name",n.target.value)}}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"f.message"}],domProps:{value:t.message},on:{input:function(n){n.target.composing||e.$set(t,"message",n.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.condition,expression:"f.condition"}],attrs:{type:"text",placeholder:"beacon,^engaged"},domProps:{value:t.condition},on:{input:function(n){n.target.composing||e.$set(t,"condition",n.target.value)}}}),e._v(" "),n("small",[e._v("DELAY (seconds, keep 0 for instant send)")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.delay,expression:"f.delay"}],attrs:{type:"number"},domProps:{value:t.delay},on:{input:function(n){n.target.composing||e.$set(t,"delay",n.target.value)}}}),e._v(" "),n("button",{directives:[{name:"show",rawName:"v-show",value:!t.confirmed,expression:"!f.confirmed"}],on:{click:function(t){return e.confirmFlow(s)}}},[e._v("Confirm")])])})],2),e._v(" "),n("div",{staticClass:"col col-6"},[n("small",[e._v("PHONE BOOK")]),e._v(" "),n("div",{staticClass:"phonebook"},[n("table",e._l(e.users,function(t){return n("tr",[n("td",[e._v(e._s(t.number))]),e._v(" "),n("td",e._l(t.tags,function(t){return n("small",[e._v("#"+e._s(t))])}),0)])}),0)]),e._v(" "),n("small",[e._v("TAGS")]),e._v(" "),n("div",{staticClass:"tags-list"},e._l(e.tagsAvailable,function(t){return n("span",{staticClass:"tag"},[e._v(e._s(t))])}),0),e._v(" "),n("small",[e._v("FLOWS")]),e._v(" "),n("textarea",{staticClass:"output",attrs:{readonly:""},domProps:{value:e.jsonOutput}}),e._v(" "),n("small",[e._v("HISTORY")]),e._v(" "),n("textarea",{staticClass:"output",attrs:{readonly:""},domProps:{value:e.historyOutput}})])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("p",[this._v("Click Confirm All to send the current flows.")]),this._v(" "),t("p",[this._v("Click Confirm to send one flow.")]),this._v(" "),t("p",[this._v("Click Add Flow to add a new flow.")])])}]};var c={name:"Analyzer",mounted:function(){var e=new URLSearchParams(window.location.search).get("q");this.userInput=e,this.analyze();var t=this;setTimeout(function(){t.flag()},500)},data:function(){return{userInput:"",topics:[],categories:[],entities:[],result:[],flaggingResult:[],rules:[{keywords:["kindly pay"],entities:["Computer virus","Error"]},{keywords:["word"],entities:["Microsoft"]},{keywords:["excel"],entities:["Microsoft"]},{keywords:["payment","advice"],entities:["Customer"]},{keywords:["confirmation","attached"],entities:["Payment"]},{keywords:["account","address"],entities:[]},{keywords:["standby","undersigned"],entitles:["Letter of credit"]},{keywords:["virus","firewall"],entities:[]}]}},methods:{analyze:function(){this.result=[],this.entities=[];var e=this;fetch("https://fishvisor-extract.glitch.me/keywords?text="+encodeURIComponent(this.userInput)).then(function(t){t.json().then(function(t){e.result=t})}),fetch("https://fishvisor-extract.glitch.me/nlp?text="+encodeURIComponent(this.userInput)).then(function(t){t.json().then(function(t){e.entities=t.response.entities.map(function(e){return e.entityEnglishId}).filter(function(e){return e.length>0})})})},containKeyword:function(e,t){return-1!==t.match(/\w+/g).map(function(e){return e.toLowerCase()}).indexOf(e.toLowerCase())},containTopic:function(e,t){return-1!==t.indexOf(e)},flag:function(){this.flaggingResult=[];for(var e=0;e<this.rules.length;e++){var t={keywords:this.rules[e].keywords,entities:this.rules[e].entities,outcome:this.validate(this.userInput,this.entities,this.rules[e])};this.flaggingResult.push(t),0==this.flaggingResult.filter(function(e){return e.outcome}).length&&(this.flaggingResult=[])}},validate:function(e,t,n){var s=this;return n.keywords.reduce(function(t,n){return t=t&&s.containKeyword(n,e)},!0)&&t.reduce(function(e,n){return e=e||s.containTopic(n,t)},!1)}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.userInput,expression:"userInput"}],domProps:{value:e.userInput},on:{input:function(t){t.target.composing||(e.userInput=t.target.value)}}}),e._v(" "),n("button",{on:{click:function(t){return e.analyze()}}},[e._v("Analyze")]),e._v(" "),n("button",{on:{click:function(t){return e.flag()}}},[e._v("Flag it")]),e._v(" "),n("div",[n("h3",[e._v("All keywords")]),e._v(" "),n("div",{staticClass:"word-list"},e._l(e.result,function(t){return n("span",{staticClass:"word"},[e._v(e._s(t)+" ")])}),0),e._v(" "),n("div",{staticClass:"word-list"},e._l(e.entities,function(t){return n("span",{staticClass:"entity"},[e._v("["+e._s(t)+"] ")])}),0),e._v(" "),e._l(e.flaggingResult,function(t){return n("div",{staticClass:"flag",class:{positive:t.outcome}},[n("div",[n("strong",[e._v("Keywords:")]),e._v(" "+e._s(t.keywords&&t.keywords.join(", ")))]),e._v(" "),n("div",[n("strong",[e._v("Topics:")]),e._v(" "+e._s(t.entities&&t.entities.join(", ")))]),e._v("\n      "+e._s(t.outcome)+"\n    ")])})],2)])},staticRenderFns:[]};var d={name:"App",components:{HelloWorld:n("VU/8")(a,l,!1,function(e){n("phzo")},"data-v-0cb0cb4e",null).exports,Dispatcher:n("VU/8")(c,u,!1,function(e){n("KbiS")},"data-v-cd7b328e",null).exports}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("Dispatcher")],1)},staticRenderFns:[]};var v=n("VU/8")(d,f,!1,function(e){n("b9Fd")},null,null).exports;s.a.config.productionTip=!1,new s.a({el:"#app",components:{App:v},template:"<App/>"})},b9Fd:function(e,t){},phzo:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.41273decdc45bc625f3d.js.map